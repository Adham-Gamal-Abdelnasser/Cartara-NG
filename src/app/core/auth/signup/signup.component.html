<section class="m-4 py-10">
    <h1 class="text-center main text-3xl capitalize text-gray-500">
        <app-letter>C</app-letter>artara
        <app-letter>I</app-letter>s
        <app-letter>W</app-letter>aiting 
        <app-letter>Y</app-letter>ou 
    </h1> 
    <form [formGroup]="signUpForm" (ngSubmit)="signUp()" class="own-container text-sky-500">
        <!-- @for (input of signUpFields; track input.id) {
            <app-field [inputField]="input"></app-field>
        } -->


        <!-- ! name -->
        @let nameControl = signUpForm.get('name');
        <div class="card w-5/6 mx-auto my-6">
            <label for="name"  [class]="{
                'text-sky-500': nameControl?.valid && nameControl?.touched,
                'text-red-500': nameControl?.invalid && nameControl?.touched,
            }" class="main text-sky-500 capitalize">name</label>
            <input type="text" formControlName="name" id="name" [class]="{
                'border-b-sky-500': nameControl?.valid && nameControl?.touched,
                'border-b-red-500': nameControl?.invalid && nameControl?.touched,
            }" class="w-full border-b-2 border-b-gray-500 outline-none px-2 py-1 focus:border-sky-500" />
            @if(nameControl?.errors && nameControl?.touched){
                <app-errormessage>
                    @if(nameControl?.getError('required')){ Name is required } 
                    @else if (nameControl?.getError('minlength')) { Name must be at least 3 characters } 
                    @else if (nameControl?.getError('maxlength')) { Name must be at most 15 characters}
                </app-errormessage>
            }
        </div>


        <!-- ! email -->
        @let emailControl = signUpForm.get('email');
        <div class="card w-5/6 mx-auto my-6">
            <label for="email" class="main text-sky-500 capitalize" [class]="{
                'text-sky-500': emailControl?.valid && emailControl?.touched,
                'text-red-500': emailControl?.invalid && emailControl?.touched,
            }" class="main text-sky-500 capitalize">email</label>
            <input type="email" formControlName="email" id="email" [class]="{
                'border-b-sky-500': emailControl?.valid && emailControl?.touched,
                'border-b-red-500': emailControl?.invalid && emailControl?.touched,
            }" class="w-full border-b-2 border-b-gray-500 outline-none px-2 py-1 focus:border-sky-500" />
            @if (emailControl?.errors && emailControl?.touched) {
                <app-errormessage>
                    @if(emailControl?.getError('required')){ Email is required}
                    @else if(emailControl?.getError('email')){ Email is invalid}
                </app-errormessage>
            }
        </div>



        <!-- ! password -->
        @let passwordControl = signUpForm.get('password');
        <div class="card w-5/6 mx-auto my-6">
            <label for="passowrd" class="main text-sky-500 capitalize" [class]="{
                'text-sky-500': passwordControl?.valid && passwordControl?.touched,
                'text-red-500': passwordControl?.invalid && passwordControl?.touched,
            }" class="main text-sky-500 capitalize">password</label>
            <input type="password" formControlName="password" id="passowrd" [class]="{
                'border-b-sky-500': passwordControl?.valid && passwordControl?.touched,
                'border-b-red-500': passwordControl?.invalid && passwordControl?.touched,
            }" class="w-full border-b-2 border-b-gray-500 outline-none px-2 py-1 focus:border-sky-500" />
            @if (passwordControl?.errors && passwordControl?.touched) {
                <app-errormessage>
                    @if(passwordControl?.getError('required')){ Password is required}
                    @else if(passwordControl?.getError('pattern')){ Password must be at least 5 characters containing capital lettters, small ones and numbers}
                </app-errormessage>
            }
        </div>



        <!-- ! rePassword -->
        @let rePasswordControl = signUpForm.get('rePassword');
        <div class="card w-5/6 mx-auto my-6">
            <label for="rePassword" class="main text-sky-500 capitalize" [class]="{
                'text-sky-500': rePasswordControl?.valid && rePasswordControl?.touched,
                'text-red-500': rePasswordControl?.invalid && rePasswordControl?.touched,
            }" class="main text-sky-500 capitalize">re passowrd</label>
            <input type="password" formControlName="rePassword" id="rePassword" [class]="{
                'border-b-sky-500': rePasswordControl?.valid && rePasswordControl?.touched,
                'border-b-red-500': rePasswordControl?.invalid && rePasswordControl?.touched,
            }" class="w-full border-b-2 border-b-gray-500 outline-none px-2 py-1 focus:border-sky-500" />
            @if ((rePasswordControl?.errors && rePasswordControl?.touched) || (rePasswordControl?.getError('mismatch') && rePasswordControl?.touched)) {
                <app-errormessage>
                    @if(rePasswordControl?.getError('required')){ Re-pssword is required}
                    @else if(rePasswordControl?.getError('mismatch')){ Passwords are not the same}
                </app-errormessage>
            }
        </div>



        <!-- ! phone -->
        @let phoneControl = signUpForm.get('phone');
        <div class="card w-5/6 mx-auto my-6">
            <label for="phone" class="main text-sky-500 capitalize" [class]="{
               'text-sky-500': phoneControl?.valid && phoneControl?.touched,
               'text-red-500': phoneControl?.invalid && phoneControl?.touched,
            }" class="main text-sky-500 capitalize">phone</label>
            <input type="tel" formControlName="phone" id="phone" [class]="{
            'border-red-500': phoneControl?.invalid && phoneControl?.touched
            }" class="w-full border-b-2 border-b-gray-500 outline-none px-2 py-1 focus:border-sky-500" />
            @if (phoneControl?.errors && phoneControl?.touched) {
                <app-errormessage>
                    @if(phoneControl?.getError('required')){ Phone is required}
                    @else if(phoneControl?.getError('pattern')){ Phone must be 11 numbers begins with 010, 011, 012 and 015 }
                </app-errormessage>
            }
        </div>

        <button [disabled]="signUpForm.invalid || (isLoading | async)" class="w-5/6 cursor-pointer mx-auto flex justify-center gap-2 mt-7 rounded-xl text-zinc-100 main p-2 bg-sky-500 transitioned hover:bg-transparent hover:text-sky-500 border-2 hover:border-sky-500">
            Submit
            @if((isLoading | async)){
                <lucide-angular [img]="loader"  class="animate-spin"></lucide-angular>
            }
        </button>
    </form>
</section> 